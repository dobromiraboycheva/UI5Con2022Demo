/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/suite/ui/commons/library","./SvgBase","sap/ui/base/ManagedObject","sap/ui/core/theming/Parameters","sap/m/CheckBox","sap/m/library"],function(t,e,r,i,o,n,s){"use strict";var a=s.ValueCSSColor,u=e.networkgraph.ElementStatus,c=e.networkgraph.HeaderCheckboxState;var l=r.extend("sap.suite.ui.commons.networkgraph.ElementBase",{metadata:{properties:{title:{type:"string",group:"Misc",defaultValue:null},description:{type:"string",group:"Misc",defaultValue:null},status:{type:"string",group:"Appearance",defaultValue:u.Standard}},aggregations:{attributes:{type:"sap.suite.ui.commons.networkgraph.ElementAttribute",multiple:true,singularName:"attribute"}}},renderer:{}});l.prototype.scrollToElement=function(){var t=this.getParent();if(t){t._scrollToElement(this)}};l.prototype._afterRenderingBase=function(){var e=this.getParent(),r,i;var o=e&&e._isUseNodeHtml()&&this.isA("sap.suite.ui.commons.networkgraph.Node"),n=this.isA("sap.suite.ui.commons.networkgraph.Group");if(!o&&!n){if(this._cannotAppendInnerHtml()){r=this.$().parent();i=this._convertToSvg(t.parseHTML(this._render()));r[0].replaceChild(i,this.$()[0])}else{this.$()[0].outerHTML=this._render()}}this._afterRendering()};l.prototype._removeFromInvalidatedControls=function(){try{this.getUIArea()._onControlRendered(this)}catch(t){}};l.prototype._setFocus=function(t){var e=t?"addClass":"removeClass";this.$()[e](this.FOCUS_CLASS)};l.prototype._replaceId=function(e,r){if(e.attr("id")){e.attr("id",e.attr("id")+r)}e.removeAttr("data-sap-ui");var i=e.children();if(i.length===0){return}i.each(function(e,i){this._replaceId(t(i),r)}.bind(this))};l.prototype._useInLayout=function(){return true};l.prototype._hasFocus=function(){return this.$().hasClass(this.FOCUS_CLASS)};l.prototype._hasDefaultStatus=function(t){t=t||this.getStatus();return t===u.Error||t===u.Information||t===u.Warning||t===u.Success};l.prototype._hasCustomStatus=function(t){t=t||this.getStatus();if(t===u.Standard||this._hasDefaultStatus(t)){return false}return!!t};l.prototype._isCustomStatusColor=function(t){return t!==l.ColorType.BorderWidth&&t!==l.ColorType.BorderStyle};l.prototype._getElementId=function(t){return t?this.getId()+t:this.getId()};l.prototype._getColor=function(t,e){var r=this.getParent(),i,n,s="";var u=function(){if(typeof this.getSelected==="function"&&this.getSelected()){if(t===l.ColorType.Background||t===l.ColorType.Content||t===l.ColorType.Border){t="Selected"+t}if(t==l.ColorType.HeaderContent&&this._isBox()){t=l.ColorType.Content}}}.bind(this);e=e||this.getStatus();if(!this._hasCustomStatus(e)){return""}if(!r||!t){return""}n=r._oStatuses[e];if(n){if(t.indexOf("Focus")!==-1){if(!n.getUseFocusColorAsContentColor()){return""}t=t.replace("Focus","Content")}u();i="get"+t+"Color";var c=n[i]();if(c){var s=o.get(c);if(!s&&c&&a.isValid(c)){s=c}}}return s?s:""};l.prototype._getStatusValue=function(t,e){var r=this.getParent(),i;e=e||this.getStatus();if(!this._hasCustomStatus(e)){return""}if(!r||!t){return""}i=r._oStatuses[e];if(i){return i["get"+t]()}return""};l.prototype._getStatusStyle=function(t,e){var r="";if(!this._hasCustomStatus()){return""}Object.keys(t).forEach(function(e){var i=this._isCustomStatusColor(t[e])?this._getColor(t[e]):this._getStatusValue(t[e]);if(i){if(r){r+=";"}r+=e+":"+i}},this);if(e&&r){r='style="'+r+'"'}return r};l.prototype._checkForProcessData=function(){var t=this.getParent();if(t&&t._bRequiresDataProcessing){t._processData()}};l.prototype.getStyleObject=function(t){var e={};if(t){var r=t.split(";");for(var i=0;i<r.length;i++){if(r[i]){var o=r[i].split(":");e[o.splice(0,1)[0]]=o.join(":")}}}return e};l.prototype.applyStyles=function(t,e){Object.keys(e).forEach(function(r){t.style(r,e[r])})};l.prototype.getVisibleAttributes=function(){return this.getAttributes().filter(function(t){return t.getVisible()})};l.prototype.setProperty=function(t,e,r){var o=Object.getPrototypeOf(this).aProcessRequiredProperties;i.prototype.setProperty.call(this,t,e,r);if(o&&o.indexOf(t)!==-1&&this.getParent()){this.getParent()._bRequiresDataProcessing=true}};l.prototype.toString=function(){return this.getMetadata()._sClassName+" - "+this.getTitle()};l.prototype._correctTitle=function(t){if(this.getTitle()){var e=this.$().find("."+t);if(e[0]){var r=e[0].getBBox().width,i=parseInt(e.attr("maxwidth"),10);if(r>i){this._createText(e[0],{text:this.getTitle(),hCenter:true})}}}};l.prototype._renderTitle=function(t){var e=10;var r=this._renderControl("g",{"clip-path":"url(#"+this.getId()+"-title-clip)"},false);r+=this._renderText({attributes:{style:t.style,class:t.class,x:t.x,y:t.y,maxWidth:t.maxWidth},text:t.title,height:e});r+="</g>";return r};l.prototype._renderClipPath=function(t){var e=this._renderControl("clipPath",{id:t.id},false);e+=this._renderControl("rect",{x:t.x,y:t.y,width:t.width||this._iWidth,height:t.height||this._iHeight,direction:t.direction||""});e+="</clipPath>";return e};l.prototype._renderClonedControl=function(t,e){if(t.mapRender){var r=e.$().clone();this._replaceId(r,t.idSufix);t.renderManager.unsafeHtml(r[0].outerHTML)}else{t.renderManager.renderControl(e)}};l.prototype._appendActionButton=function(e,r){var i=e.id?'id="'+e.id+'"':"";var o="<div "+i+' title="'+e.title+'"class="sapSuiteUiCommonsNetworkGraphDivActionButtonBackground">';o+='<div class="sapSuiteUiCommonsNetworkGraphDivActionButton ';if(!e.enable){o+='sapSuiteUiCommonsNetworkGraphDivActionButtonDisabled"';o+='style = " display: none'}o+='">';o+=this._renderHtmlIcon(e.icon,e.class||"");o+="</div>";o+='<div class="sapSuiteUiCommonsNetworkActionButtonFocusCircle"></div>';o+="</div>";var n=t(o);if(e.enable&&e.click){n.on("click",e.click);n.on("click",function(t){if(this.getParent()){this.getParent().setFocus({item:this,button:n[0]},true)}}.bind(this))}r.append(n)};l._isRectOnScreen=function(t,e,r,i,o,n,s,a){return Math.max(t,e)>o&&Math.min(t,e)<n&&Math.max(r,i)>s&&Math.min(r,i)<a};l.prototype._isOnScreen=function(t,e,r,i){return false};l.prototype._setHeaderCheckBoxState=function(t){if(t!==c.Hidden){this._getHeaderCheckbox().setSelected(t===c.Checked);this._getHeaderCheckbox().setVisible(true)}else if(this.getAggregation("_checkBox")){this._getHeaderCheckbox().setVisible(false)}this.setProperty("headerCheckBoxState",t)};l.prototype.setVisible=function(t){var e=this.getParent();this.setProperty("visible",t);if(e){e.setFocus(null);e._setupKeyboardNavigation()}return this};l.prototype.setStatus=function(t){var e=this.getParent();this.setProperty("status",t);if(e&&e._bIsLayedOut){e.updateLegend()}return this};l.ColorType=Object.freeze({BorderStyle:"BorderStyle",BorderWidth:"BorderWidth",Background:"Background",Border:"Border",Content:"Content",HeaderContent:"HeaderContent",SelectedBorder:"SelectedBorder",SelectedBackground:"SelectedBackground",SelectedContent:"SelectedContent",HoverBackground:"HoverBackground",HoverBorder:"HoverBorder",HoverContent:"HoverContent",Focus:"Focus",HoverFocus:"HoverFocus",SelectedFocus:"SelectedFocus"});return l});