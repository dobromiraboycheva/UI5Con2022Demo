/*
 * ! OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/mdc/p13n/Engine"],function(e){"use strict";var n=function(n){var t=n&&n.isA&&n.isA("sap.ui.mdc.Table")&&n.isTableBound();var r=n&&n.isA&&n.isA("sap.ui.mdc.Chart");if(t||r){if(!n._bWaitForBindChanges){n._bWaitForBindChanges=true;e.getInstance().waitForChanges(n).then(function(){if(t){n.rebind()}else if(r){n.rebind()}delete n._bWaitForBindChanges})}}};var t=function(e,t,r,i){if(i){e.resetRevertData()}else{e.setRevertData(r)}n(t)};var r=function(e,n,r,i){return new Promise(function(o,a){var s=r.modifier;var u=i?e.getRevertData():e.getContent();Promise.resolve().then(s.getProperty.bind(s,n,"sortConditions")).then(function(r){var a=r?r.sorters:[];var c={name:u.name,descending:u.descending};a.splice(u.index,0,c);r={sorters:a};s.setProperty(n,"sortConditions",r);t(e,n,c,i);o()}).catch(function(e){a(e)})})};var i=function(e,n,r,i){return new Promise(function(o,a){var s=r.modifier;var u=i?e.getRevertData():e.getContent();Promise.resolve().then(s.getProperty.bind(s,n,"sortConditions")).then(function(r){var c=r?r.sorters:[];if(!c){a()}var f=c.filter(function(e){return e.name===u.name});var d=c.indexOf(f[0]);c.splice(d,1);r={sorters:c};s.setProperty(n,"sortConditions",r);t(e,n,u,i);o()}).catch(function(e){a(e)})})};var o=function(e,n,r,i){return new Promise(function(o,a){var s=r.modifier;var u=i?e.getRevertData():e.getContent();Promise.resolve().then(s.getProperty.bind(s,n,"sortConditions")).then(function(r){var a=r?r.sorters:[];var c=a.filter(function(e){return e.name===u.name});var f=a.indexOf(c[0]);a.splice(u.index,0,a.splice(f,1)[0]);r={sorters:a};s.setProperty(n,"sortConditions",r);t(e,n,u,i);o()}).catch(function(e){a(e)})})};var a={};a.removeSort={changeHandler:{applyChange:function(e,n,t){return i(e,n,t,false)},completeChangeContent:function(e,n,t){},revertChange:function(e,n,t){return r(e,n,t,true)}},layers:{USER:true}};a.addSort={changeHandler:{applyChange:function(e,n,t){return r(e,n,t,false)},completeChangeContent:function(e,n,t){},revertChange:function(e,n,t){return i(e,n,t,true)}},layers:{USER:true}};a.moveSort={changeHandler:{applyChange:function(e,n,t){return o(e,n,t)},completeChangeContent:function(e,n,t){},revertChange:function(e,n,t){return o(e,n,t,true)}},layers:{USER:true}};return a});