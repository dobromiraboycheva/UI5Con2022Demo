/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/Device","sap/base/security/encodeXML","sap/ui/thirdparty/jqueryui/jquery-ui-position"],function(e,t,a){"use strict";var i={};i.render=function(e,t){t.doBeforeRendering();e.write("<div");e.writeControlData(t);e.addClass("sapUiRoadMap");e.writeClasses();e.writeAttribute("tabindex","0");var a=t.getTooltip_AsString();if(a){e.writeAttributeEscaped("title",a)}e.writeAttribute("style","width:"+(t.getWidth()?t.getWidth():"100%")+";");e.write(">");s(e,t,true);e.write("<ul");e.writeAttribute("id",t.getId()+"-steparea");e.addClass("sapUiRoadMapStepArea");e.writeClasses();if(sap.ui.getCore().getConfiguration().getAccessibility()){e.writeAttribute("role","group");e.writeAttributeEscaped("aria-label",b("RDMP_DEFAULT_TOOLTIP",[]));if(a){e.writeAttributeEscaped("title",a)}}e.write(">");var i=t.getSteps();for(var r=0;r<i.length;r++){var n=i[r];if(n.getSubSteps().length>0){g(e,t,n)}else{d(e,t,n)}}e.write("</ul>");s(e,t,false);e.write("</div>")};i.selectStepWithId=function(e,t){var a=e.getSelectedStep();if(a){r(a).removeClass("sapUiRoadMapSelected")}if(t){r(t).addClass("sapUiRoadMapSelected")}if(sap.ui.getCore().getConfiguration().getAccessibility()){if(a){r(a+"-box").removeAttr("aria-checked")}if(t){r(t+"-box").attr("aria-checked",true)}}};i.selectStep=function(t,a,s,d,n,o){if(!o){i.selectStepWithId(t,a.getId())}if(!s&&a.getSubSteps().length>0){var l=a.getSubSteps();var p=a.$();var f=p.hasClass("sapUiRoadMapExpanded");var u=1;var g=function(){u--;if(u>0){return}if(n){n(!f?"expanded":"collapsed")}i.updateStepArea(t)};var v=function(a,i,s){var n=r(a);if(!e.fx.off&&!d){n.width(i?"0px":t.iStepWidth);var o=r(a+"-label");o.addClass("sapUiRoadMapHidden");if(i){n.toggleClass("sapUiRoadMapHidden")}n.animate({width:i?t.iStepWidth:"0px"},"fast",function(){if(!i){n.toggleClass("sapUiRoadMapHidden")}n.width("");o.removeClass("sapUiRoadMapHidden");if(s){s()}})}else{n.toggleClass("sapUiRoadMapHidden");if(s){s()}}};p.toggleClass("sapUiRoadMapExpanded");if(sap.ui.getCore().getConfiguration().getAccessibility()){var c=p.hasClass("sapUiRoadMapExpanded");a.$("box").attr("aria-expanded",c);a.$("expandend-box").attr("aria-expanded",c)}for(var b=0;b<l.length;b++){if(l[b].getVisible()){u++;v(l[b].getId(),!f,g)}}v(a.getId()+"-expandend",!f,g)}else{if(n){n("selected")}}};i.updateStepArea=function(e){if(e.iStepWidth!=-1){var t=e.$("steparea");var a=e.$("Start");var i=e.$("End");var r=e.$();var s=t.scrollLeft();var d=r.width()-a.outerWidth(true)-i.outerWidth(true);var n=e.getNumberOfVisibleSteps();var o=S(e);if(n<1){n=o}else{n=Math.min(n,o)}var l=Math.floor(d/e.iStepWidth);var p=Math.min(n,l);t.width(p*e.iStepWidth).scrollLeft(s);c(e)}};i.updateScrollArea=function(e,t){i.updateStepArea(e);if(!t){var a=e.$("steparea");var s=R(e,false);if(e.getFirstVisibleStep()){var d=r(e.getFirstVisibleStep());if(d.length){s=C(a,d)}}M(e,s+h()*a.scrollLeft(),true)}};i.isVisibleRef=function(t,a){var i=t.$("steparea");var r=i.children(":visible");for(var s=0;s<r.length;s++){var d=e(r.get(s));if(d.attr("id")==a){var n=C(i,d);return n>=0&&n<i.width()}}return false};i.getFirstVisibleRef=function(t){var a=t.$("steparea");var i=a.children(":visible");for(var r=0;r<i.length;r++){var s=e(i.get(r));if(C(a,s)==0){return s}}return null};i.setStepLabel=function(e,t){var i=t?a(t):"";e.$("label").html(i);e.$("expandend-label").html(i);if(!sap.ui.getCore().getConfiguration().getAccessibility()){return}e.$("box").attr("aria-label",p(e,t));e.$("expandend-box").attr("aria-label",p(e,t))};i.setStepEnabled=function(e,t,a){var i=t.$();var r=t.$("expandend");if(a){i.removeClass("sapUiRoadMapDisabled");r.removeClass("sapUiRoadMapDisabled");if(sap.ui.getCore().getConfiguration().getAccessibility()){t.$("box").removeAttr("aria-disabled");t.$("expandend-box").removeAttr("aria-disabled")}return false}else{var s=e.getSelectedStep()==t.getId();if(s){i.removeClass("sapUiRoadMapSelected")}i.addClass("sapUiRoadMapDisabled");r.addClass("sapUiRoadMapDisabled");if(sap.ui.getCore().getConfiguration().getAccessibility()){var d=t.$("box");d.attr("aria-disabled",true);if(s){d.removeAttr("aria-checked")}t.$("expandend-box").attr("aria-disabled",true)}return s}};i.setStepVisible=function(e,t,a,i){var r=t.$();var s=t.$("expandend");var d=e.getSelectedStep()==t.getId();var n=t.getParent();if(a){if(n.getEnabled()&&n.getVisible()&&n.getExpanded()){if(i){r.removeClass("sapUiRoadMapHidden")}else{r.addClass("sapUiRoadMapHidden")}}}else{if(i){r.removeClass("sapUiRoadMapHidden")}else{r.addClass("sapUiRoadMapHidden")}var o=t.getSubSteps();if(o.length>0&&t.getExpanded()){if(i){s.removeClass("sapUiRoadMapHidden")}else{s.addClass("sapUiRoadMapHidden")}for(var l=0;l<o.length;l++){if(o[l].getVisible()){var p=o[l].$();if(e.getSelectedStep()==o[l].getId()){d=true;p.removeClass("sapUiRoadMapSelected");o[l].$("box").removeAttr("aria-checked")}if(i){p.removeClass("sapUiRoadMapHidden")}else{p.addClass("sapUiRoadMapHidden")}}}}}return d};i.setRoadMapWidth=function(e,t){var a=e.$();a.attr("style","width:"+(t?t:"100%")+";")};i.scrollToNextStep=function(e,t,a){var i=t;if(t=="first"||t=="last"){i=R(e,t=="last")}M(e,i,false,a)};i.addEllipses=function(t){if(!t){return}var i=t.$("label");var r=t.getLabel();var s=r+"";var d=e('<label class="sapUiRoadMapTitle" style="display:none;position:absolute;overflow:visible;font-weight:bold;height:auto">'+s+"</label>");d.width(i.width());e(sap.ui.getCore().getStaticAreaRef()).append(d);var o=false;while(s.length>0&&d.height()>i.height()){s=s.substr(0,s.length-1);d.html(a(s+"..."));o=true}if(o){i.html("<span>"+a(s)+"</span>");i.attr("title",t.getLabel())}else{i.attr("title",n(t))}d.remove()};i.updateStepAria=function(e){if(!sap.ui.getCore().getConfiguration().getAccessibility()){return}var t=e.getParent()instanceof sap.ui.commons.RoadMap;var a=e.getParent()[t?"getSteps":"getSubSteps"]();for(var i=0;i<a.length;i++){var r=f(a[i]);var s=u(a[i]);var d=a[i].$("box");d.attr("aria-posinset",r);d.attr("aria-setsize",s);if(t&&a[i].getSubSteps().length>0){d=a[i].$("expandend-box");d.attr("aria-posinset",r);d.attr("aria-setsize",s)}}};var r=function(t){return e(t?document.getElementById(t):null)};var s=function(e,t,a){var i=a?"Start":"End";e.write("<div");e.writeAttribute("id",t.getId()+"-"+i);e.writeAttribute("tabindex","-1");var r=true;e.addClass(r?"sapUiRoadMap"+i+"Scroll":"sapUiRoadMap"+i+"Fixed");e.addClass("sapUiRoadMapDelim");e.addClass("sapUiRoadMapContent");e.writeClasses();e.write("></div>")};var d=function(e,t,a,i,r,s){e.write("<li");if(s){e.writeAttribute("id",s)}else{e.writeElementData(a)}var d=v(t,a);a.__stepName=d;var p=n(a);e.addClass("sapUiRoadMapContent");e.addClass("sapUiRoadMapStep");if(!a.getVisible()){e.addClass("sapUiRoadMapHidden")}if(a.getEnabled()){if(t.getSelectedStep()==a.getId()){e.addClass("sapUiRoadMapSelected")}}else{e.addClass("sapUiRoadMapDisabled")}if(i){for(var f=0;f<i.length;f++){e.addClass(i[f])}}e.writeClasses();e.write(">");o(e,s?s:a.getId(),1);e.write("<div");e.writeAttribute("id",(s?s:a.getId())+"-box");e.writeAttribute("tabindex","-1");e.addClass("sapUiRoadMapStepBox");e.writeClasses();e.writeAttributeEscaped("title",p);l(e,t,a,r?true:false);e.write("><span>");e.write(d);e.write("</span>");if(r){r(e,t,a)}e.write("</div>");e.write("<label");e.writeAttribute("id",(s?s:a.getId())+"-label");e.addClass("sapUiRoadMapTitle");e.writeAttributeEscaped("title",p);e.writeClasses();e.write(">");var u=a.getLabel();if(u){e.writeEscaped(u)}e.write("</label>");o(e,s?s:a.getId(),2);e.write("</li>")};var n=function(e){var t=e.getTooltip_AsString();if(!t&&!e.getTooltip()&&sap.ui.getCore().getConfiguration().getAccessibility()){t=b("RDMP_DEFAULT_STEP_TOOLTIP",[e.__stepName])}return t||""};var o=function(e,t,a){e.write("<div");e.writeAttribute("id",t+"-add"+a);e.addClass("sapUiRoadMapStepAdd"+a);e.writeClasses();e.write("></div>")};var l=function(e,t,a,i){if(!sap.ui.getCore().getConfiguration().getAccessibility()){return}e.writeAttribute("role","treeitem");if(a.getEnabled()){e.writeAttribute("aria-checked",t.getSelectedStep()==a.getId())}else{e.writeAttribute("aria-disabled",true)}e.writeAttribute("aria-haspopup",i);e.writeAttribute("aria-level",a.getParent()instanceof sap.ui.commons.RoadMap?1:2);e.writeAttribute("aria-posinset",f(a));e.writeAttribute("aria-setsize",u(a));e.writeAttributeEscaped("aria-label",p(a,a.getLabel()));if(!i){return}e.writeAttribute("aria-expanded",a.getExpanded())};var p=function(e,t){var a=e.getParent()instanceof sap.ui.commons.RoadMap&&e.getSubSteps().length>0;var i=t||"";if(e.getEnabled()){i=b(a?"RDMP_ARIA_EXPANDABLE_STEP":"RDMP_ARIA_STANDARD_STEP",[i])}return i};var f=function(e){var t=e.getParent()instanceof sap.ui.commons.RoadMap;var a=e.getParent()[t?"indexOfStep":"indexOfSubStep"](e);var i=0;var r=e.getParent()[t?"getSteps":"getSubSteps"]();for(var s=0;s<a;s++){if(!r[s].getVisible()){i++}}return a+1-i};var u=function(e){var t=e.getParent()instanceof sap.ui.commons.RoadMap;var a=e.getParent()[t?"getSteps":"getSubSteps"]();var i=a.length;for(var r=0;r<a.length;r++){if(!a[r].getVisible()){i--}}return i};var g=function(e,t,a){var i=function(e,t,a,i,r){e.write("<div");e.writeAttribute("id",a+"-ico");e.addClass("sapUiRoadMapStepIco");if(r){e.addClass(r)}e.writeClasses();e.write("></div>")};var r=a.getExpanded();d(e,t,a,r?["sapUiRoadMapExpanded"]:null,function(e,t,a){i(e,t,a.getId(),r?"roundtripstart.gif":"roundtrip.gif")});var s=a.getSubSteps();for(var n=0;n<s.length;n++){var o=["sapUiRoadMapSubStep"];if(!r&&s[n].getVisible()){o.push("sapUiRoadMapHidden")}d(e,t,s[n],o)}o=["sapUiRoadMapExpanded","sapUiRoadMapStepEnd"];if(!r){o.push("sapUiRoadMapHidden")}d(e,t,a,o,function(e,t,a){i(e,t,a.getId()+"-expandend","roundtripend.gif")},a.getId()+"-expandend")};var v=function(e,t){var a=t.getParent();if(a===e){return a.indexOfStep(t)+1}var i=a.indexOfSubStep(t);if(i<26){return String.fromCharCode(97+i)}var r=Math.floor(i/26)-1;var s=i%26;return String.fromCharCode(97+r,97+s)};var c=function(e){var t=h();var a=e.$("steparea");var i=w(a);var r=e.$("Start");r.removeClass("sapUiRoadMapStartScroll").removeClass("sapUiRoadMapStartFixed");r.addClass(t*i>=e.iStepWidth?"sapUiRoadMapStartScroll":"sapUiRoadMapStartFixed");var s=e.$("End");s.removeClass("sapUiRoadMapEndScroll").removeClass("sapUiRoadMapEndFixed");var d=a.get(0).scrollWidth-t*i-a.width()<e.iStepWidth;s.addClass(d?"sapUiRoadMapEndFixed":"sapUiRoadMapEndScroll")};var b=function(e,t){var a=sap.ui.getCore().getLibraryResourceBundle("sap.ui.commons");if(a){return a.getText(e,t)}return e};var S=function(e){var t=0;var a=e.getSteps();for(var i=0;i<a.length;i++){if(a[i].getVisible()){t++;if(a[i].getExpanded()){t++;var r=a[i].getSubSteps();for(var s=0;s<r.length;s++){if(r[s].getVisible()){t++}}}}}return t};var C=function(e,t){var a=t.position().left;if(sap.ui.getCore().getConfiguration().getRTL()){a=e.width()-a-t.outerWidth()}return a};var h=function(){return sap.ui.getCore().getConfiguration().getRTL()?-1:1};var w=function(e){if(sap.ui.getCore().getConfiguration().getRTL()&&t.browser.webkit){return-1*(e.get(0).scrollWidth-e.scrollLeft()-e.width())}return e.scrollLeft()};var R=function(e,a){var i=e.$("steparea").get(0).scrollWidth;if(sap.ui.getCore().getConfiguration().getRTL()&&t.browser.webkit){return a?0:-1*i}return a?i:0};var M=function(t,a,r,s){var d=t.$("steparea");d.stop(false,true);if(a=="next"){a=d.scrollLeft()+t.iStepWidth*h()}else if(a=="prev"){a=d.scrollLeft()-t.iStepWidth*h()}else if(a=="keep"){a=d.scrollLeft()}else{a=a*h()}var n=function(){c(t);if(s){var e=i.getFirstVisibleRef(t);s(e.attr("id"))}};if(!e.fx.off&&!r){d.animate({scrollLeft:a},"fast",n)}else{d.scrollLeft(a);n()}};return i},true);