/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","./TextField","./library","./TextAreaRenderer","sap/ui/Device","sap/ui/events/KeyCodes","sap/ui/dom/jquery/cursorPos","sap/ui/dom/jquery/selectText"],function(t,e,o,r,n,p){"use strict";var s=e.extend("sap.ui.commons.TextArea",{metadata:{library:"sap.ui.commons",deprecated:true,properties:{height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},cols:{type:"int",group:"Dimension",defaultValue:null},rows:{type:"int",group:"Dimension",defaultValue:null},wrapping:{type:"sap.ui.core.Wrapping",group:"Appearance",defaultValue:null},cursorPos:{type:"int",group:"Appearance",defaultValue:null},explanation:{type:"string",group:"Misc",defaultValue:null},labeledBy:{type:"string",group:"Identification",defaultValue:null,deprecated:true}}}});s.prototype.exit=function(){this._detachEventHandler()};s.prototype.onBeforeRendering=function(){this._detachEventHandler()};s.prototype.onAfterRendering=function(){e.prototype.onAfterRendering.apply(this,arguments);this._attachEventHandler()};s.prototype._attachEventHandler=function(){var e=this.$();this.proChHandlerId=e.on("propertychange",t.proxy(this.oninput,this))};s.prototype._detachEventHandler=function(){var t=this.$();if(this.proChHandlerId){t.off("propertychange",this.oninput);this.proChHandlerId=null}};s.prototype.onfocusin=function(t){e.prototype.onfocusin.apply(this,arguments);this.bFocus=true;t.preventDefault()};s.prototype.onsapfocusleave=function(o){e.prototype.onsapfocusleave.apply(this,arguments);var r=this.getFocusDomRef();if(r&&n.browser.firefox){if(r.selectionStart!=r.selectionEnd){t(r).selectText(r.selectionStart,r.selectionStart)}}this.bFocus=false;o.preventDefault();o.stopPropagation()};s.prototype.applyFocusInfo=function(t){e.prototype.applyFocusInfo.apply(this,arguments);return this};s.prototype.onkeypress=function(t){e.prototype.onkeypress.apply(this,arguments);if(!this.getEditable()||!this.getEnabled()||this.getMaxLength()<=0){return}var o=t.which||t.keyCode;var r=this.getDomRef();if(document.selection){var n=document.selection.createRange();if(n.text.length>0){return}}else{if(r.selectionStart!=r.selectionEnd){return}}if(r.value.length>=this.getMaxLength()&&(o>p.DELETE||o==p.ENTER||o==p.SPACE)&&!t.ctrlKey){t.preventDefault();t.stopPropagation()}};s.prototype.onkeyup=function(o){var r=this.getDomRef();this.setProperty("cursorPos",t(r).cursorPos(),true);e.prototype.onkeyup.apply(this,arguments)};s.prototype.onsapenter=function(t){t.stopPropagation()};s.prototype.onsapnext=function(e){if(t(this.getFocusDomRef()).data("sap.InNavArea")&&e.keyCode!=p.END){e.preventDefault();return}this._checkCursorPosForNav(e,true)};s.prototype.onsapprevious=function(e){if(t(this.getFocusDomRef()).data("sap.InNavArea")&&e.keyCode!=p.HOME){e.preventDefault();return}this._checkCursorPosForNav(e,false)};s.prototype.onsapnextmodifiers=s.prototype.onsapnext;s.prototype.onsappreviousmodifiers=s.prototype.onsapprevious;s.prototype.onsapend=s.prototype.onsapnext;s.prototype.onsaphome=s.prototype.onsapprevious;s.prototype.onmouseup=function(e){var o=this.getDomRef();this.setProperty("cursorPos",t(o).cursorPos(),true)};s.prototype.onpaste=function(t){if(!this.getEditable()||!this.getEnabled()||this.getMaxLength()<=0){return}var e=this.getDomRef();if(e.value.length>=this.getMaxLength()&&e.selectionStart==e.selectionEnd){t.preventDefault();t.stopPropagation()}};s.prototype.oninput=function(o){if(o.originalEvent&&o.originalEvent.propertyName&&o.originalEvent.propertyName.toLowerCase()!="value"){return}if(this.getEditable()&&this.getEnabled()&&this.getMaxLength()>0){var r=this.getDomRef();if(r.value.length>this.getMaxLength()){r.value=r.value.substring(0,this.getMaxLength())}}e.prototype.oninput.apply(this,arguments);var n=this.getDomRef();this.setProperty("cursorPos",t(n).cursorPos(),true)};s.prototype.setMaxLength=function(t){this.setProperty("maxLength",t,true);var e=this.getDomRef();if(e&&e.value.length>t&&t>0){e.value=e.value.substring(0,t)}var o=this.getValue();if(o.length>t&&t>0){this.setProperty("value",o.substring(0,t))}return this};s.prototype.setCursorPos=function(e){this.setProperty("cursorPos",e,true);if(this.bFocus){t(this.getDomRef()).cursorPos(e)}return this};return s});