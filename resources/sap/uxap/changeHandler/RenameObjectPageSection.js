/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/Utils","sap/base/Log","sap/ui/fl/changeHandler/BaseRename"],function(e,t,r){"use strict";var n={propertyName:"title",changePropertyName:"newText",translationTextType:"XGRP"};var o=r.createRenameChangeHandler(n);o._getControlForRename=function(e,t){var r,n;return Promise.resolve().then(function(){return t.getAggregation(e,"subSections")}).then(function(n){r=n;if(r.length!==1){return[]}return Promise.all([t.getPropertyBindingOrProperty(r[0],"title"),t.getProperty(t.getParent(e),"subSectionLayout")])}).then(function(t){n=t[0];if(r&&r.length===1&&n&&typeof n==="object"||typeof n==="string"&&n.trim()!==""&&t[1]==="TitleOnTop"){return r[0]}return e})};o.applyChange=function(e,r,a){var i=a.modifier;var p=n.propertyName;var u=e.getDefinition();var s=u.texts[n.changePropertyName];var g=s.value;return o._getControlForRename(r,i).then(function(r){if(typeof g==="string"&&g.trim()===""){throw new Error("Change cannot be applied as ObjectPageSubSection's title cannot be empty: ["+u.layer+"]"+u.namespace+"/"+u.fileName+"."+u.fileType)}if(u.texts&&s&&typeof g==="string"){return Promise.resolve().then(function(){return i.getPropertyBindingOrProperty(r,p)}).then(function(t){e.setRevertData(t);i.setPropertyBindingOrProperty(r,p,g);return true})}else{t.error("Change does not contain sufficient information to be applied: ["+u.layer+"]"+u.namespace+"/"+u.fileName+"."+u.fileType)}})};o.revertChange=function(e,r,a){var i=e.getRevertData(),p=a.modifier,u=n.propertyName;return o._getControlForRename(r,p).then(function(r){if(i||i===""){p.setPropertyBindingOrProperty(r,u,i);e.resetRevertData();return true}else{t.error("Change doesn't contain sufficient information to be reverted. Most Likely the Change didn't go through applyChange.")}})};return o},true);