/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/chart/coloring/ColoringUtils","sap/chart/coloring/gradation/rankedMeasureValues/RankedMeasureUtils","sap/chart/ChartLog","sap/ui/thirdparty/jquery"],function(e,r,n,a){"use strict";var i={};var t=["SingleColorScheme","DivergingColorScheme","TargetColorScheme"];var o=function(a,i,o,s){if(!s.bMBC){throw new n("error","colorings.Gradation",'"RankedMeasureValues" only applys to Heatmap.')}e.checkColoringMeasure(i,o.aMsr,a);i.forEach(function(e){var i=Object.keys(a[e]).filter(function(e){return t.indexOf(e)>-1});if(i.length>1){throw new n("error","colorings.Gradation.RankedMeasureValues",'One and only one of "'+t.join('" or "')+'" can be applied to the measure, '+e+".")}else{var o=i[0]||t[0];if(r[o].validate){r[o].validate(a,e)}}})};i.qualify=function(i,s,l,u){o(i,s,l,u);var c=[],g=l.aDim.map(function(e){return e.getName()}).sort();a.each(i,function(a,o){if(s.length&&s.indexOf(a)===-1){return}var f=e.find(a,l.aMsr);if(Object.keys(o).length===0){o["SingleColorScheme"]={}}Object.keys(o).forEach(function(e){if(t.indexOf(e)===-1){return}c.sMethod=e;var s=null,l=null;var h=Array.isArray(o[e].RankingPerAggregationLevel)?o[e].RankingPerAggregationLevel:[];h.forEach(function(e){if(e&&e.VisibleDimensions){if(Array.isArray(e.VisibleDimensions)&&e.VisibleDimensions.sort().join(",")===g.join(",")){s=e}}else{l=e}});s=s||l;if(s||h.length===0&&e==="SingleColorScheme"){if(r[e].levels){r[e].levels(i,a,s)}c.push({type:e,msr:f,settings:o,byAggregation:u.bFiltered?null:s})}else{throw new n("error","colorings.Gradation.RankedMeasureValues",'No aggregation level in "'+e+'" of the measure, '+a+",  matched with current visible dimensions.")}})});return c};i.parse=function(e){var n={msr:e.msr,legend:{}};r[e.type].parse(e,n);return n};i.createScales=function(e){return r[e.sMethod].createScales(e)};i.getContextHandler=function(e){var r=e[0];var n=r.msr.getName();var a=r.parsed.legend;return function(e){var r=e.getProperty(n);a.min=Math.min(a.min,r);a.max=Math.max(a.max,r)}};return i});